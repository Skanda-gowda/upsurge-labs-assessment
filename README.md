# Autonomous AI Agent Streamlit Frontend

This project provides a web-based user interface built with Streamlit to interact with an autonomous AI agent. It allows users to input instructions, run the agent, view the results, and manage files generated by the agent within a designated output directory. It also includes functionality to generate a basic PDF report from the agent's output.

## Features

*   **Agent Interaction:** Input natural language instructions for the AI agent.
*   **Run Agent:** Execute the underlying AI agent logic (imported from `agent.planner`).
*   **Result Display:** Shows the final output/answer provided by the agent.
*   **Verbose Logging:** Optionally displays the detailed thought process and actions taken by the agent (if captured).
*   **Output File Browser:**
    *   Lists files generated by the agent in the `outputs/` directory.
    *   Displays file names and sizes.
    *   Sorts files by modification time (newest first).
    *   Provides a **Refresh** button to update the file list.
*   **File Management:**
    *   **Download:** Download selected output files.
    *   **Delete:** Delete selected output files with a confirmation step.
*   **Content Preview:**
    *   Displays the content of selected text-based files (.txt, .md, .py, .json, .csv, etc.).
    *   Provides syntax highlighting for common code/markup languages.
    *   Handles large files by showing a truncated preview and a warning.
    *   Indicates when preview is unavailable for non-text or binary files.
*   **PDF Report Generation:**
    *   Generates a PDF document containing the last agent output.
    *   Includes placeholder logic to embed charts (using Matplotlib).
    *   Allows downloading the generated PDF report.
*   **Environment Variable Handling:** Uses a `.env` file for sensitive information like API keys.
*   **API Key Check:** Detects the likely required API key based on the agent implementation and warns the user if it's missing.
*   **Custom Styling:** Applies a custom dark theme for a better user experience.
*   **Error Handling:** Provides user-friendly messages for common errors (missing API key, agent errors, file operation errors).
*   **State Management:** Uses Streamlit's `session_state` to remember the last agent result, logs, and selected file across interactions and reruns.
*   **Caching:**
    *   Uses `st.cache_resource` to initialize the agent executor once, improving performance on subsequent runs.
    *   Uses `st.cache_data` to cache the file list, with manual invalidation via the Refresh button.

## Approach & Architecture

1.  **Streamlit Frontend (`app.py`):**
    *   Acts as the main entry point and user interface layer.
    *   Handles user input (instructions, button clicks, file selections).
    *   Manages the application's state (`st.session_state`).
    *   Displays agent results, file lists, and previews.
    *   Orchestrates calls to the agent logic and file system operations.

2.  **Agent Logic (`agent/planner.py` - *External*)**:
    *   This module (expected to be present) contains the core AI agent implementation (likely using frameworks like LangChain, AutoGen, etc.).
    *   The `initialize_agent` function is imported and used to create the agent executor instance.
    *   `app.py` invokes the agent using `agent_executor.invoke({"input": instruction})`.
    *   The agent interacts with its tools and LLMs to process the user's instruction. Agent output (including intermediate steps if verbose) is handled by `app.py`.

3.  **Output Directory (`outputs/`)**:
    *   A dedicated directory where the agent is expected to save any generated files (reports, data, code, etc.).
    *   `app.py` scans this directory to populate the file browser.
    *   Generated PDF reports are also saved here before being offered for download.

4.  **Environment Configuration (`.env`)**:
    *   Stores necessary API keys (e.g., `OPENAI_API_KEY`, `GOOGLE_API_KEY`, `HUGGINGFACEHUB_API_TOKEN`) required by the agent's underlying LLM.
    *   `python-dotenv` is used to load these variables into the environment when the app starts.

5.  **State Management (`st.session_state`)**:
    *   Crucial for maintaining context between user interactions in Streamlit.
    *   Stores the last agent response (`last_final_output`, `last_verbose_output`) so it can be redisplayed or used for PDF generation without re-running the agent.
    *   Keeps track of the currently selected file in the browser (`selected_file_display`).
    *   Manages the two-step delete confirmation process (`confirm_key`).

6.  **File Handling (`pathlib`)**:
    *   Uses Python's `pathlib` for robust and cross-platform path manipulation.
    *   Handles scanning the output directory (`rglob`), getting file stats (`stat`), reading files (`open`), and deleting files (`unlink`).

7.  **PDF Generation (`fpdf2`, `matplotlib`)**:
    *   Uses the `fpdf2` library to construct the PDF document structure (text, layout).
    *   Uses `matplotlib` to generate placeholder charts, save them as temporary image files, and embed them into the PDF. (Note: The chart data is currently static example data).

8.  **Caching (`st.cache_resource`, `st.cache_data`)**:
    *   `st.cache_resource` prevents the potentially expensive re-initialization of the AI agent on every script rerun (e.g., after clicking a button).
    *   `st.cache_data` caches the results of scanning the `outputs/` directory. A "Refresh" button is provided to explicitly clear this cache and rescan, ensuring the file list is up-to-date after external changes or deletions.

## Setup & Installation

1.  **Prerequisites:**
    *   Python 3.8+
    *   Git (optional, for cloning)

2.  **Clone the Repository:**
    ```bash
    git clone <your-repo-url>
    cd <your-repo-directory>
    ```

3.  **Create a Virtual Environment (Recommended):**
    ```bash
    python -m venv venv
    # On Windows
    .\venv\Scripts\activate
    # On macOS/Linux
    source venv/bin/activate
    ```

4.  **Install Dependencies:**
    Make sure you have a `requirements.txt` file listing all necessary packages (streamlit, python-dotenv, fpdf2, matplotlib, langchain, langchain-openai/google-genai/huggingface_hub, etc.).
    ```bash
    pip install -r requirements.txt
    ```

5.  **Create and Configure `.env` File:**
    Create a file named `.env` in the project root directory. Add the necessary API key(s) based on the LLM used in your `agent/planner.py`:
    ```dotenv
    # Example for OpenAI
    OPENAI_API_KEY="sk-..."

    # Example for Google Gemini
    # GOOGLE_API_KEY="AIza..."

    # Example for Hugging Face Hub
    # HUGGINGFACEHUB_API_TOKEN="hf_..."
    ```
    *The application attempts to detect which key is needed.*

6.  **Ensure Agent Logic Exists:**
    Make sure the `agent/planner.py` file exists and correctly implements the `initialize_agent` function compatible with the expected agent framework (e.g., LangChain).

## Usage

1.  Activate your virtual environment (if you created one).
2.  Navigate to the project's root directory in your terminal.
3.  Run the Streamlit application:
    ```bash
    streamlit run app.py
    ```
4.  The application should open in your web browser automatically.
5.  Enter instructions in the text area and click "Run Agent".
6.  Browse, preview, download, or delete files generated in the `outputs/` directory using the file browser section.
7.  Generate a PDF report from the last agent output if needed.

## Code Structure

```plaintext
.
├── agent/                  # Directory containing the core AI agent logic
│   └── planner.py        # Script responsible for initializing and defining the agent
│
├── outputs/              # Default directory where the agent saves generated files
│   └── .gitkeep          # Placeholder file to ensure the directory exists in Git
│
├── .env                  # File storing environment variables (API keys) - **Not committed to Git**
│
├── app.py                # The main Streamlit application script:
│                         #   - Defines the User Interface (UI)
│                         #   - Handles user input and interactions
│                         #   - Initializes and invokes the agent from agent/planner.py
│                         #   - Manages the display of results and logs
│                         #   - Implements the file browser, preview, download, and delete features
│                         #   - Includes PDF generation logic
│
├── requirements.txt      # Lists all Python package dependencies for the project
│
└── README.md             # Project documentation explaining setup, usage, and approach

